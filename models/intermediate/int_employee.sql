SELECT
    jj.EMPLOYEE_ID,
    jj.EMPLOYEE_NAME,
    jj.EMPLOYEE_CITY,
    jj.EMPLOYEE_ADDRESS,
    jj.EMPLOYEE_TITLE,
    jj.EMPLOYEE_ANNUAL_SALARY,
    round(jj.EMPLOYEE_ANNUAL_SALARY/365,2) as EMPLOYEE_DAILY_SALARY,
    jj.EMPLOYEE_HIRE_DATE,
    qq.EMPLOYEE_QUIT_DATE,
    CASE WHEN qq.EMPLOYEE_QUIT_DATE IS NULL THEN 'until now'
        ELSE CAST(DATEDIFF('days', jj.EMPLOYEE_HIRE_DATE, qq.EMPLOYEE_QUIT_DATE) AS VARCHAR)
    END as WORKED_DAYS
    
FROM {{ ref('base_GOOGLE_DRIVE_requests_JOINS') }} AS jj
LEFT JOIN {{ ref('base_GOOGLE_DRIVE_requests_QUITS') }} AS qq
ON jj.EMPLOYEE_ID = qq.EMPLOYEE_ID
